{"job":{"components":{"12515":{"id":12515,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":128,"y":80,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[12524],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_ODS_LEAD"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"select IFNULL(T.TREE_KEY,0) AS TREE_KEY,IFNULL(S.SALE_PERSON_KEY,0) AS SALE_PERSON_KEY,\nIFNULL(C.CUST_KEY,0)AS CUST_KEY,\nIFNULL(F.FOREST_KEY,0) AS FOREST_KEY,\n\tCUSTOMER_ID AS LEAD_ID,\n\tCONTACT_EMAIL,\n\tCUSTOMER_FIRST_NAME,\n\tCUSTOMER_LAST_NAME,\n\tCONTACT_NAME,\n\tcf.FINAL_LEAD_SCORE_TIER AS LEAD_SCORE,\n\tDEAL_PIPELINE,\n\tDEAL_ID AS LEAD_DEAL_ID,   \n\tcf.PREFERRED_FOREST,\n\tREGIONAL_DEPOSIT_FOREST,\n\tDEAL_FOREST,    \n\tTOUR_SCHEDULED_FOREST,\n\tTOUR_FOREST,\n    CONTRACT_ID,\n\tCONTRACT_FOREST,\n\tCONTRACT_VALUE,\n\tARBOR_TAG_ID,\n\tDEAL_STAGE AS LEAD_STAGE,\n\tDEAL_CLOSED_TIMESTAMP,\n\tSALES_REP_NAME,\n\tSALES_REP_EMAIL,\n\tSDR_NAME,\n    SALES_REP_ID,\n\tPROJECTED_DEAL_AMOUNT,\n\tTOUR_SCHEDULED_CHANNEL,\n\tTOUR_CHANNEL,\n\tDEPOSIT_TYPE,\n\tPITCH_SCHEDULE_TYPE,\n\tFOREST,\n\tCF.TREE_ID,\n\tCONTACT_CREATED,\n\t--SALES_LEAD_MQL_TIMESTAMP,\n    least(sales_lead_mql_timestamp,pitch_scheduled, pitch_held,tour_scheduled, tour_held, contract_signed) as sales_lead_mql_timestamp,\n\t--PITCH_SCHEDULED,\n    least(pitch_scheduled, pitch_held, tour_scheduled, tour_held, contract_signed) as pitch_scheduled,\n\tCF.SQL_TIMESTAMP,\n\t--PITCH_HELD,\n    least(pitch_held,tour_scheduled, tour_held, contract_signed) as pitch_held,\n\tDEPOSIT_TIMESTAMP,\n\t--TOUR_SCHEDULED,\n    least(tour_scheduled, tour_held, contract_signed) as tour_scheduled,\n\t--TOUR_HELD,\n    least(tour_held, contract_signed) as tour_held,\n\tCONTRACT_SIGNED\nfrom \n--customer_funnel_no_backfill CF\nBPF_ODS.\"PUBLIC\".ODS_LEAD cf\nLEFT OUTER JOIN\nBPF_DATAMART.\"PUBLIC\".DIM_CUSTOMER  C\n--ON CF.LEAD_ID = C.CUST_ID\nON CF.CUSTOMER_ID = C.CUST_ID\nLEFT OUTER JOIN \nBPF_DATAMART.\"PUBLIC\".DIM_SALES_PERSON S\nON CF.SALES_REP_ID = S.SALES_PERSON_ID \nLEFT OUTER JOIN \nBPF_DATAMART.\"PUBLIC\".DIM_FOREST F\nON CF.FOREST = F.FOREST_FULLNAME \nLEFT OUTER JOIN BPF_DATAMART.\"PUBLIC\".DIM_TREE_PRODUCT T\nON CF.TREE_ID=T.TREE_ID \n\n\n/*\n\n-- SRC_FACT LEAD\nwith customer_funnel_no_backfill \nas (\nselect \n-- Customer\nCAST(c.customer_id AS VARCHAR) AS LEAD_ID\n,c.contact_email AS LEAD_EMAIL\n,c.CUSTOMER_FIRST_NAME \n,c.CUSTOMER_LAST_NAME \n,c.customer_name as contact_name\n,c.final_lead_score_tier\n\n\n-- Deal\n,c.deal_pipeline AS PIPELINE\n,CAST(c.deal_id AS VARCHAR(500)) AS LEAD_DEAL_ID\n,c.preferred_forest\n,c.regional_deposit_forest\n,c.deal_forest\n,t.scheduled_forest as tour_scheduled_forest\n,v.forest as tour_forest\n,con.CONTRACT_ID\n,con.forest as contract_forest\n,con.contract_value\n,con.arbor_tag_id\n,REPLACE(c.deal_stage,'\\\\','')AS LEAD_STAGE\n,c.deal_closed_timestamp\n,c.sales_rep_name\n,c.sales_rep_email\n,c.sdr_name\n,c.SALES_REP_ID\n,c.projected_deal_amount\n,t.channel as tour_scheduled_channel\n,v.channel as tour_channel\n,c.deposit_type\n,pitch_schedule_type\n,v.FOREST\n,v.tree_id\n\n-- Timestamps\n,c.contact_created_timestamp as contact_created\n,c.sales_lead_mql_timestamp\n,p.created_at as pitch_scheduled\n,c.sql_timestamp\n,coalesce(c.sal_timestamp, cap.created_at, pc.pitch_call) as pitch_held\n,c.deposit_timestamp\n,t.created_at as tour_scheduled\n-- ,t.scheduled_tour_timestamp as tour_scheduled_for\n,coalesce(v.checked_in_at, v.checked_out_at) as tour_held\n,con.signed_at as contract_signed\n,CURRENT_TIMESTAMP() AS INSERT_DATE\n,NULL AS UPDATE_DATE \nfrom \nBPF_ODS.\"PUBLIC\".ODS_CUSTOMER as c \nleft outer join \nBPF_ODS.\"PUBLIC\".ODS_PITCH_SCHEDULED as p \non c.customer_id = p.customer_id and p.event_number = 1\nleft outer join \nBPF_ODS.\"PUBLIC\".ODS_PITCH_HELD  as cap \non c.customer_id = cap.customer_id and cap.event_number = 1\nleft outer join \n BPF_ODS.\"PUBLIC\".ODS_PITCH_CALL as pc \non c.deal_id = pc.deal_id and pc.pitch_call_length >= 15\nleft outer join \n BPF_ODS.\"PUBLIC\".ODS_TOUR_SHEDULED as t\non c.customer_id = t.customer_id and t.event_number = 1\nleft outer join \n BPF_ODS.\"PUBLIC\".ODS_TOUR_HELD as v \n--on c.deal_id = v.deal_id \nON CAST(c.deal_id AS VARCHAR) = CAST(v.deal_id AS VARCHAR) \nAND visit_num = 1\nleft outer join \nBPF_ODS.\"PUBLIC\".ODS_CONTRACT as con\n--on c.deal_id = con.hubspot_deal_id\nON CAST(c.deal_id AS VARCHAR) = CAST(con.hubspot_deal_id AS VARCHAR) \n)\n*/"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"12516":{"id":12516,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":432,"y":80,"width":32,"height":32,"inputConnectorIDs":[12523],"outputConnectorIDs":[12522],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"E_FACT_LEAD"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TO_TIMESTAMP_NTZ(CURRENT_TIMESTAMP(9))"},"2":{"slot":2,"type":"STRING","value":"C_INSERT_UPD_DATE"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CONCAT(\"SRC_EMAIL\",'~',\"LEAD_DEAL_ID\")"},"2":{"slot":2,"type":"STRING","value":"C_UNQ_KEY"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(to_number(to_char(\"SRC_PTCH_SCHD_DT\",'YYYYMMDD'),'99999999'),0)"},"2":{"slot":2,"type":"STRING","value":"C_PTCH_SCHD_DT_KEY"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(to_number(to_char(\"SRC_PTCH_SCHD_DT\",'YYYYMMDD'),'99999999'),0)"},"2":{"slot":2,"type":"STRING","value":"C_TOUR_SCHD_DT_KEY"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_EMAIL\",'NA')"},"2":{"slot":2,"type":"STRING","value":"C_EMAIL"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_LEAD_STAGE\",'NA')"},"2":{"slot":2,"type":"STRING","value":"C_STG"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_CUST_ID\",'NA')"},"2":{"slot":2,"type":"STRING","value":"C_LEAD_ID"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_FN\",'NA')"},"2":{"slot":2,"type":"STRING","value":"C_FN"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_LN\",'NA')"},"2":{"slot":2,"type":"STRING","value":"C_LN"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_FULLNM\",'NA')"},"2":{"slot":2,"type":"STRING","value":"C_FULLNM"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_LEAD_SCORE\",'0')"},"2":{"slot":2,"type":"STRING","value":"C_SCORE"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_DEAL_PIPE_LINE\",'NA')"},"2":{"slot":2,"type":"STRING","value":"C_PIPLN"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_DEAL_ID\",'NA')"},"2":{"slot":2,"type":"STRING","value":"C_DEAL_ID"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_PREF_FOREST\",'NA')"},"2":{"slot":2,"type":"STRING","value":"C_DEAL_PRFD_FOREST"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_DEAL_FOREST\",'NA')"},"2":{"slot":2,"type":"STRING","value":"C_DEAL_FOREST"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_TOUR_SCHD_FOREST\",0)"},"2":{"slot":2,"type":"STRING","value":"C_TOUR_SCHD_FOR"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_CONTRCT_ID\",0)"},"2":{"slot":2,"type":"STRING","value":"C_CNTRCT_ID"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_CONTRCT_VALUE\",0.00)"},"2":{"slot":2,"type":"STRING","value":"C_CONTRCT_VALUE"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(to_number(to_char(\"SRC_CONTRCT_SIGNED_DT\",'YYYYMMDD'),'99999999'),0)"},"2":{"slot":2,"type":"STRING","value":"C_CNTRCT_SGNED_DT_KEY"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(to_number(to_char(\"SRC_TOUR_HELD_DT\",'YYYYMMDD'),'99999999'),0)"},"2":{"slot":2,"type":"STRING","value":"C_TOUR_HELD_DT_KEY"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(to_number(to_char(\"SRC_DEPSOT_TMSTAMP\",'YYYYMMDD'),'99999999'),0)"},"2":{"slot":2,"type":"STRING","value":"C_DEPOST_DT_KEY"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(to_number(to_char(\"SRC_PTCH_HLD_DT\",'YYYYMMDD'),'99999999'),0)"},"2":{"slot":2,"type":"STRING","value":"C_PTCH_HELD_DT_KEY"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(to_number(to_char(\"SRC_SQL_TMSTMAP\",'YYYYMMDD'),'99999999'),0)"},"2":{"slot":2,"type":"STRING","value":"C_SQL_DT_KEY"}}},"24":{"slot":24,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(to_number(to_char(\"SRC_SALES_LEAD_MQL_TMSTMP\",'YYYYMMDD'),'99999999'),0)"},"2":{"slot":2,"type":"STRING","value":"C_SALES_LEAD_MQL_DT_KEY"}}},"25":{"slot":25,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(to_number(to_char(\"SRC_CNTRCT_CRED_DT\",'YYYYMMDD'),'99999999'),0)"},"2":{"slot":2,"type":"STRING","value":"C_CNTRCT_CRED_DT_KEY"}}},"26":{"slot":26,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_PTCH_SCHD_TYP\",'NA')"},"2":{"slot":2,"type":"STRING","value":"C_PTCH_SCHD_TYP"}}},"27":{"slot":27,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_DEPST_TYP\",'NA')"},"2":{"slot":2,"type":"STRING","value":"C_DEPST_TYP"}}},"28":{"slot":28,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_TOUR_CHNL\",'NA')"},"2":{"slot":2,"type":"STRING","value":"C_TOUR_CHNL"}}},"29":{"slot":29,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_TOUR_SCHD_CHNL\",'NA')"},"2":{"slot":2,"type":"STRING","value":"C_TOUR_SCHD_CHNL"}}},"30":{"slot":30,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_PRJCTD_DEAL_AMNT\",0.00)"},"2":{"slot":2,"type":"STRING","value":"C_PRJCD_DEAL_AMNT"}}},"31":{"slot":31,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_SDR_NAME\",'NA')"},"2":{"slot":2,"type":"STRING","value":"C_SDR_NAME"}}},"32":{"slot":32,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_SALES_REP_EMAIL\",'NA')"},"2":{"slot":2,"type":"STRING","value":"C_SALES_REP_EMAIL"}}},"33":{"slot":33,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_SALES_REP_NAME\",'NA')"},"2":{"slot":2,"type":"STRING","value":"C_SALES_REP_NM"}}},"34":{"slot":34,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(to_number(to_char(\"SRC_DEAL_CLSD_TMSTMP\",'YYYYMMDD'),'99999999'),0)\n\n"},"2":{"slot":2,"type":"STRING","value":"C_DEAL_CLSD_DT_KEY"}}},"35":{"slot":35,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(to_number(to_char(\"SRC_LEAD_CRED_DT\",'YYYYMMDD'),'99999999'),0)"},"2":{"slot":2,"type":"STRING","value":"C_LEAD_CRED_DT_KEY"}}},"36":{"slot":36,"values":{"1":{"slot":1,"type":"STRING","value":"1"},"2":{"slot":2,"type":"STRING","value":"C_DEFAULT_1"}}},"37":{"slot":37,"values":{"1":{"slot":1,"type":"STRING","value":"0"},"2":{"slot":2,"type":"STRING","value":"C_DEFAULT_0"}}},"38":{"slot":38,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_FOREST_KEY\",0)"},"2":{"slot":2,"type":"STRING","value":"C_FOREST_KEY"}}},"39":{"slot":39,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_TREE_KEY\",0)"},"2":{"slot":2,"type":"STRING","value":"C_TREE_KEY"}}},"40":{"slot":40,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_PRSN_KEY\",0)"},"2":{"slot":2,"type":"STRING","value":"C_SALES_PRSN_KEY"}}},"41":{"slot":41,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_PRJCTD_DEAL_AMNT\",0)"},"2":{"slot":2,"type":"STRING","value":"C_DEAL_AMNT"}}},"42":{"slot":42,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_CUST_KEY\",0)"},"2":{"slot":2,"type":"STRING","value":"C_CUST_KEY"}}},"43":{"slot":43,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(to_number(to_char(\"SRC_SALES_LEAD_MQL_DT\",'YYYYMMDD'),'99999999'),0)"},"2":{"slot":2,"type":"STRING","value":"C_SALES_MQL_DT_KEY"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"12517":{"id":12517,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":128,"y":176,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[12525],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_TGT_FACT_LEAD"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"FACT_LEAD"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LEAD_KEY"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"LEAD_ID"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"LEAD_FIRST_NAME"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"LEAD_LAST_NAME"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"LEAD_EMAIL"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"LEAD_SCORE"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"LEAD_STAGE"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"PIPELINE"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"LEAD_DEAL_ID"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"LEAD_CONTRACT_VALUE"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"LEAD_DEAL_AMOUNT"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"CUST_KEY"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"SALES_PRSN_KEY"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"FOREST_KEY"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"TREE_KEY"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"LEAD_CREATED_DT_KEY"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"LEAD_SQL_CREATED_DT_KEY"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"LEAD_PITCH_DT_KEY"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"PITCH_SCHEDULED_DT_KEY"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"TOUR_SCHEDULED_DT_KEY"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"PITCH_HELD_DT_KEY"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"TOUR_HELD_DT_KEY"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"CONTRACT_SIGNED_DT_KEY"}}},"24":{"slot":24,"values":{"1":{"slot":1,"type":"STRING","value":"INSERT_DATE"}}},"25":{"slot":25,"values":{"1":{"slot":1,"type":"STRING","value":"UPDATE_DATE"}}},"26":{"slot":26,"values":{"1":{"slot":1,"type":"STRING","value":"IS_LATEST"}}},"27":{"slot":27,"values":{"1":{"slot":1,"type":"STRING","value":"UNIQUE_KEY"}}},"28":{"slot":28,"values":{"1":{"slot":1,"type":"STRING","value":"SALES_LEAD_MQL_DT_KEY"}}},"29":{"slot":29,"values":{"1":{"slot":1,"type":"STRING","value":"LEAD_CONTRACT_ID"}}},"30":{"slot":30,"values":{"1":{"slot":1,"type":"STRING","value":"PITCH_SCHEDULED_TYPE"}}},"31":{"slot":31,"values":{"1":{"slot":1,"type":"STRING","value":"SDR_NAME"}}},"32":{"slot":32,"values":{"1":{"slot":1,"type":"STRING","value":"TOUR_SCHEDULED_FOREST"}}},"33":{"slot":33,"values":{"1":{"slot":1,"type":"STRING","value":"TOUR_SCHEDULED_CHANNEL"}}},"34":{"slot":34,"values":{"1":{"slot":1,"type":"STRING","value":"TOUR_HELD_FOREST"}}},"35":{"slot":35,"values":{"1":{"slot":1,"type":"STRING","value":"TOUR_HELD_CHANNEL"}}},"36":{"slot":36,"values":{"1":{"slot":1,"type":"STRING","value":"TOUR_HELD_FOREST_STEWARD"}}},"37":{"slot":37,"values":{"1":{"slot":1,"type":"STRING","value":"CONTRACT_FOREST"}}},"38":{"slot":38,"values":{"1":{"slot":1,"type":"STRING","value":"CONTRACT_CHANNEL"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PUBLIC"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BPF_DATAMART"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"12518":{"id":12518,"inputCardinality":"TWO","outputCardinality":"MANY","implementationID":-359894709,"x":303,"y":80,"width":32,"height":32,"inputConnectorIDs":[12524,12525],"outputConnectorIDs":[12523],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SCD-2"}}}},"visible":true},"2":{"slot":2,"name":"Master Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_TGT_FACT_LEAD"}}}},"visible":true},"3":{"slot":3,"name":"Match Keys","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LEAD_DEAL_ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"LEAD_ID"}}}},"visible":true},"4":{"slot":4,"name":"Compare Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LEAD_SCORE"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"LEAD_STAGE"}}}},"visible":true},"5":{"slot":5,"name":"Output Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"compare_LEAD_STAGE"},"2":{"slot":2,"type":"STRING","value":"SRC_LEAD_STAGE"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"compare_LEAD_ID"},"2":{"slot":2,"type":"STRING","value":"SRC_CUST_ID"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CONTACT_EMAIL"},"2":{"slot":2,"type":"STRING","value":"SRC_EMAIL"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CUSTOMER_FIRST_NAME"},"2":{"slot":2,"type":"STRING","value":"SRC_FN"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CUSTOMER_LAST_NAME"},"2":{"slot":2,"type":"STRING","value":"SRC_LN"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CONTACT_NAME"},"2":{"slot":2,"type":"STRING","value":"SRC_FULLNM"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"compare_LEAD_SCORE"},"2":{"slot":2,"type":"STRING","value":"SRC_LEAD_SCORE"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"compare_DEAL_PIPELINE"},"2":{"slot":2,"type":"STRING","value":"SRC_DEAL_PIPE_LINE"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"compare_LEAD_DEAL_ID"},"2":{"slot":2,"type":"STRING","value":"SRC_DEAL_ID"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"compare_PREFERRED_FOREST"},"2":{"slot":2,"type":"STRING","value":"SRC_PREF_FOREST"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"compare_DEAL_FOREST"},"2":{"slot":2,"type":"STRING","value":"SRC_DEAL_FOREST"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"compare_TOUR_SCHEDULED_FOREST"},"2":{"slot":2,"type":"STRING","value":"SRC_TOUR_SCHD_FOREST"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CONTRACT_ID"},"2":{"slot":2,"type":"STRING","value":"SRC_CONTRCT_ID"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CONTRACT_VALUE"},"2":{"slot":2,"type":"STRING","value":"SRC_CONTRCT_VALUE"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"compare_PITCH_SCHEDULED"},"2":{"slot":2,"type":"STRING","value":"SRC_PTCH_SCHD_DT"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CONTRACT_SIGNED"},"2":{"slot":2,"type":"STRING","value":"SRC_CONTRCT_SIGNED_DT"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"compare_TOUR_HELD"},"2":{"slot":2,"type":"STRING","value":"SRC_TOUR_HELD_DT"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"compare_TOUR_SCHEDULED"},"2":{"slot":2,"type":"STRING","value":"SRC_TOUR_SCHD_DT"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"compare_DEPOSIT_TIMESTAMP"},"2":{"slot":2,"type":"STRING","value":"SRC_DEPSOT_TMSTAMP"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"compare_PITCH_HELD"},"2":{"slot":2,"type":"STRING","value":"SRC_PTCH_HLD_DT"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"compare_SQL_TIMESTAMP"},"2":{"slot":2,"type":"STRING","value":"SRC_SQL_TMSTMAP"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"compare_SALES_LEAD_MQL_TIMESTAMP"},"2":{"slot":2,"type":"STRING","value":"SRC_SALES_LEAD_MQL_TMSTMP"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CONTACT_CREATED"},"2":{"slot":2,"type":"STRING","value":"SRC_CNTRCT_CRED_DT"}}},"24":{"slot":24,"values":{"1":{"slot":1,"type":"STRING","value":"compare_PITCH_SCHEDULE_TYPE"},"2":{"slot":2,"type":"STRING","value":"SRC_PTCH_SCHD_TYP"}}},"25":{"slot":25,"values":{"1":{"slot":1,"type":"STRING","value":"compare_DEPOSIT_TYPE"},"2":{"slot":2,"type":"STRING","value":"SRC_DEPST_TYP"}}},"26":{"slot":26,"values":{"1":{"slot":1,"type":"STRING","value":"compare_TOUR_CHANNEL"},"2":{"slot":2,"type":"STRING","value":"SRC_TOUR_CHNL"}}},"27":{"slot":27,"values":{"1":{"slot":1,"type":"STRING","value":"compare_TOUR_SCHEDULED_CHANNEL"},"2":{"slot":2,"type":"STRING","value":"SRC_TOUR_SCHD_CHNL"}}},"28":{"slot":28,"values":{"1":{"slot":1,"type":"STRING","value":"compare_PROJECTED_DEAL_AMOUNT"},"2":{"slot":2,"type":"STRING","value":"SRC_PRJCTD_DEAL_AMNT"}}},"29":{"slot":29,"values":{"1":{"slot":1,"type":"STRING","value":"compare_SDR_NAME"},"2":{"slot":2,"type":"STRING","value":"SRC_SDR_NAME"}}},"30":{"slot":30,"values":{"1":{"slot":1,"type":"STRING","value":"compare_SALES_REP_EMAIL"},"2":{"slot":2,"type":"STRING","value":"SRC_SALES_REP_EMAIL"}}},"31":{"slot":31,"values":{"1":{"slot":1,"type":"STRING","value":"compare_SALES_REP_NAME"},"2":{"slot":2,"type":"STRING","value":"SRC_SALES_REP_NAME"}}},"32":{"slot":32,"values":{"1":{"slot":1,"type":"STRING","value":"compare_DEAL_CLOSED_TIMESTAMP"},"2":{"slot":2,"type":"STRING","value":"SRC_DEAL_CLSD_TMSTMP"}}},"33":{"slot":33,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CONTACT_CREATED"},"2":{"slot":2,"type":"STRING","value":"SRC_LEAD_CRED_DT"}}},"34":{"slot":34,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CUST_KEY"},"2":{"slot":2,"type":"STRING","value":"SRC_CUST_KEY"}}},"35":{"slot":35,"values":{"1":{"slot":1,"type":"STRING","value":"compare_FOREST_KEY"},"2":{"slot":2,"type":"STRING","value":"SRC_FOREST_KEY"}}},"36":{"slot":36,"values":{"1":{"slot":1,"type":"STRING","value":"compare_TREE_KEY"},"2":{"slot":2,"type":"STRING","value":"SRC_TREE_KEY"}}},"37":{"slot":37,"values":{"1":{"slot":1,"type":"STRING","value":"compare_SALE_PERSON_KEY"},"2":{"slot":2,"type":"STRING","value":"SRC_PRSN_KEY"}}},"38":{"slot":38,"values":{"1":{"slot":1,"type":"STRING","value":"compare_SALES_LEAD_MQL_TIMESTAMP"},"2":{"slot":2,"type":"STRING","value":"SRC_SALES_LEAD_MQL_DT"}}}},"visible":true},"6":{"slot":6,"name":"Indicator Column","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SCD-FLAG"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"12519":{"id":12519,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":576,"y":80,"width":32,"height":32,"inputConnectorIDs":[12522],"outputConnectorIDs":[12521],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Insert_Update"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SCD-FLAG"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"N"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"SCD-FLAG"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"C"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"OR"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"12520":{"id":12520,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-1848704949,"x":705,"y":76,"width":32,"height":32,"inputConnectorIDs":[12521],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"INSERT_UPDATE"}}}},"visible":true},"200":{"slot":200,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"FACT_LEAD"}}}},"visible":true},"201":{"slot":201,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PUBLIC"}}}},"visible":true},"202":{"slot":202,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BPF_DATAMART"}}}},"visible":true},"203":{"slot":203,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BPF_SMALL"}}}},"visible":true},"204":{"slot":204,"name":"Target Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"target"}}}},"visible":true},"205":{"slot":205,"name":"Source Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"source"}}}},"visible":true},"206":{"slot":206,"name":"Join Expression","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"target\".\"LEAD_DEAL_ID\"=\"source\".\"LEAD_DEAL_ID\"  and \"target\".\"LEAD_ID\"=\"source\".\"LEAD_ID\""},"2":{"slot":2,"type":"STRING","value":"Join"}}}},"visible":true},"207":{"slot":207,"name":"When Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"target\".\"LEAD_DEAL_ID\"=\"source\".\"LEAD_DEAL_ID\""},"2":{"slot":2,"type":"STRING","value":"Update"}}}},"visible":true},"208":{"slot":208,"name":"Update Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"C_INSERT_UPD_DATE"},"2":{"slot":2,"type":"STRING","value":"UPDATE_DATE"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"C_STG"},"2":{"slot":2,"type":"STRING","value":"LEAD_STAGE"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_LEAD_SCORE"},"2":{"slot":2,"type":"STRING","value":"LEAD_SCORE"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"C_DEFAULT_0"},"2":{"slot":2,"type":"STRING","value":"IS_LATEST"}}}},"visible":true},"209":{"slot":209,"name":"Include Not Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"210":{"slot":210,"name":"Insert Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"C_LEAD_ID"},"2":{"slot":2,"type":"STRING","value":"LEAD_ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"C_FN"},"2":{"slot":2,"type":"STRING","value":"LEAD_FIRST_NAME"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"C_LN"},"2":{"slot":2,"type":"STRING","value":"LEAD_LAST_NAME"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"C_EMAIL"},"2":{"slot":2,"type":"STRING","value":"LEAD_EMAIL"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"C_SCORE"},"2":{"slot":2,"type":"STRING","value":"LEAD_SCORE"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"C_STG"},"2":{"slot":2,"type":"STRING","value":"LEAD_STAGE"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"C_PIPLN"},"2":{"slot":2,"type":"STRING","value":"PIPELINE"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"C_DEAL_ID"},"2":{"slot":2,"type":"STRING","value":"LEAD_DEAL_ID"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"C_CONTRCT_VALUE"},"2":{"slot":2,"type":"STRING","value":"LEAD_CONTRACT_VALUE"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"C_DEAL_AMNT"},"2":{"slot":2,"type":"STRING","value":"LEAD_DEAL_AMOUNT"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"C_CUST_KEY"},"2":{"slot":2,"type":"STRING","value":"CUST_KEY"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"C_SALES_PRSN_KEY"},"2":{"slot":2,"type":"STRING","value":"SALES_PRSN_KEY"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"C_FOREST_KEY"},"2":{"slot":2,"type":"STRING","value":"FOREST_KEY"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"C_TREE_KEY"},"2":{"slot":2,"type":"STRING","value":"TREE_KEY"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"C_LEAD_CRED_DT_KEY"},"2":{"slot":2,"type":"STRING","value":"LEAD_CREATED_DT_KEY"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"C_SQL_DT_KEY"},"2":{"slot":2,"type":"STRING","value":"LEAD_SQL_CREATED_DT_KEY"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"C_DEFAULT_0"},"2":{"slot":2,"type":"STRING","value":"LEAD_PITCH_DT_KEY"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"C_PTCH_SCHD_DT_KEY"},"2":{"slot":2,"type":"STRING","value":"PITCH_SCHEDULED_DT_KEY"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"C_TOUR_SCHD_DT_KEY"},"2":{"slot":2,"type":"STRING","value":"TOUR_SCHEDULED_DT_KEY"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"C_PTCH_HELD_DT_KEY"},"2":{"slot":2,"type":"STRING","value":"PITCH_HELD_DT_KEY"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"C_TOUR_HELD_DT_KEY"},"2":{"slot":2,"type":"STRING","value":"TOUR_HELD_DT_KEY"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"C_CNTRCT_SGNED_DT_KEY"},"2":{"slot":2,"type":"STRING","value":"CONTRACT_SIGNED_DT_KEY"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"C_INSERT_UPD_DATE"},"2":{"slot":2,"type":"STRING","value":"INSERT_DATE"}}},"24":{"slot":24,"values":{"1":{"slot":1,"type":"STRING","value":"C_DEFAULT_1"},"2":{"slot":2,"type":"STRING","value":"IS_LATEST"}}},"25":{"slot":25,"values":{"1":{"slot":1,"type":"STRING","value":"C_UNQ_KEY"},"2":{"slot":2,"type":"STRING","value":"UNIQUE_KEY"}}},"26":{"slot":26,"values":{"1":{"slot":1,"type":"STRING","value":"C_SALES_MQL_DT_KEY"},"2":{"slot":2,"type":"STRING","value":"SALES_LEAD_MQL_DT_KEY"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"12521":{"id":12521,"sourceID":12519,"targetID":12520},"12522":{"id":12522,"sourceID":12516,"targetID":12519},"12523":{"id":12523,"sourceID":12518,"targetID":12516},"12524":{"id":12524,"sourceID":12515,"targetID":12518},"12525":{"id":12525,"sourceID":12517,"targetID":12518}},"notes":{"12514":{"id":12514,"x":71,"y":20,"width":699,"height":201,"text":"FACT_LEAD","colour":"e6e63c"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"BPF_CUSTFNTL_FACT_LEAD_OLD","description":"","type":"TRANSFORMATION","tag":"4fa4bad2-a536-4374-9542-fa837165df22"}}