{"job":{"components":{"58483":{"id":58483,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":608,"y":0,"width":32,"height":32,"inputConnectorIDs":[59180],"outputConnectorIDs":[59185],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Calculator 0"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TO_TIMESTAMP_NTZ(CURRENT_TIMESTAMP())"},"2":{"slot":2,"type":"STRING","value":"C_INS_UPD_DT"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"58503":{"id":58503,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":211954775,"x":848,"y":0,"width":32,"height":32,"inputConnectorIDs":[59188],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BPF_CUST_FNNL_REV_HIST"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BPF_CUST_FNNL_REV_HIST"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CUST_ID"},"2":{"slot":2,"type":"STRING","value":"CUST_ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CUST_KEY"},"2":{"slot":2,"type":"STRING","value":"CUST_KEY"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CUST_EMAIL"},"2":{"slot":2,"type":"STRING","value":"CUST_EMAIL"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CUST_FIRST_NAME"},"2":{"slot":2,"type":"STRING","value":"CUST_FIRST_NAME"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CUST_LAST_NAME"},"2":{"slot":2,"type":"STRING","value":"CUST_LAST_NAME"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"compare_FINAL_LEAD_SCORE_TIER"},"2":{"slot":2,"type":"STRING","value":"FINAL_LEAD_SCORE_TIER"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"compare_DEAL_ID"},"2":{"slot":2,"type":"STRING","value":"DEAL_ID"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"compare_DEAL_STAGE"},"2":{"slot":2,"type":"STRING","value":"DEAL_STAGE"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"compare_REV_HIST_CHANGE_TYPE"},"2":{"slot":2,"type":"STRING","value":"REV_HIST_CHANGE_TYPE"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"compare_REV_HIST_EVENT_TYPE"},"2":{"slot":2,"type":"STRING","value":"REV_HIST_EVENT_TYPE"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"compare_REV_HIST_METADATA"},"2":{"slot":2,"type":"STRING","value":"REV_HIST_METADATA"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"compare_REV_HIST_OCCURRED_DT"},"2":{"slot":2,"type":"STRING","value":"REV_HIST_OCCURRED_DT"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"C_INS_UPD_DT"},"2":{"slot":2,"type":"STRING","value":"INSERT_DT"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"compare_EVENT_OCCURRENCE_ORDER"},"2":{"slot":2,"type":"STRING","value":"REV_HIST_ORDER"}}}},"visible":true},"5":{"slot":5,"name":"Truncate","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Append"}}}},"visible":true},"200":{"slot":200,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PUBLIC"}}}},"visible":true},"201":{"slot":201,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BPF_DATAMART"}}}},"visible":true},"202":{"slot":202,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BPF_SMALL"}}}},"visible":true},"203":{"slot":203,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"58967":{"id":58967,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":208,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[59176],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SQL 0"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT\n\tCUST.CUST_ID ,\n\tCUST.CUST_KEY,\n\tCUST.CUST_EMAIL,\n\tCUST.CUST_FIRST_NAME ,\n\tCUST.CUST_LAST_NAME ,\n\tCUST.FINAL_LEAD_SCORE_TIER,\n\tDCUST.DEAL_ID ,\n\tDCUST.DEAL_STAGE,\n\tLSC.REV_HIST_CHANGE_TYPE,\n\tLSC.EVENT_TYPE AS REV_HIST_EVENT_TYPE,\n\tREPLACE(LSC.METADATA,'\"','') AS REV_HIST_METADATA,\n\tLSC.EVENT_OCCURRED_AT AS REV_HIST_OCCURRED_DT,\n\tLSC.LATEST_FLAG AS EVENT_OCCURRENCE_ORDER\nFROM\n\tBPF_DATAMART.\"PUBLIC\".VW_CUST_FNNL_REV_HIST LSC\nLEFT OUTER JOIN BPF_DATAMART.\"PUBLIC\".DIM_CUSTOMER CUST ON\n\tCUST.CUST_EMAIL = LSC.EMAIL\nLEFT OUTER JOIN BPF_ODS.\"PUBLIC\".ODS_DEAL_CUSTOMER DCUST ON\n\tDCUST.CUSTOMER_ID = CUST.CUST_ID"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"59130":{"id":59130,"inputCardinality":"TWO","outputCardinality":"MANY","implementationID":-359894709,"x":384,"y":48,"width":32,"height":32,"inputConnectorIDs":[59169,59176],"outputConnectorIDs":[59180],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Detect Changes 0"}}}},"visible":true},"2":{"slot":2,"name":"Master Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BPF_CUST_FNNL_REV_HIST 0"}}}},"visible":true},"3":{"slot":3,"name":"Match Keys","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CUST_EMAIL"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"REV_HIST_CHANGE_TYPE"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"REV_HIST_EVENT_TYPE"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"REV_HIST_OCCURRED_DT"}}}},"visible":true},"4":{"slot":4,"name":"Compare Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CUST_ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CUST_KEY"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"CUST_EMAIL"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"CUST_FIRST_NAME"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"CUST_LAST_NAME"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"FINAL_LEAD_SCORE_TIER"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"DEAL_ID"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"DEAL_STAGE"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"REV_HIST_CHANGE_TYPE"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"REV_HIST_EVENT_TYPE"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"REV_HIST_METADATA"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"REV_HIST_OCCURRED_DT"}}}},"visible":true},"5":{"slot":5,"name":"Output Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"master_CUST_ID"},"2":{"slot":2,"type":"STRING","value":"master_CUST_ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CUST_ID"},"2":{"slot":2,"type":"STRING","value":"compare_CUST_ID"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"master_CUST_KEY"},"2":{"slot":2,"type":"STRING","value":"master_CUST_KEY"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CUST_KEY"},"2":{"slot":2,"type":"STRING","value":"compare_CUST_KEY"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"master_CUST_EMAIL"},"2":{"slot":2,"type":"STRING","value":"master_CUST_EMAIL"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CUST_EMAIL"},"2":{"slot":2,"type":"STRING","value":"compare_CUST_EMAIL"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"master_CUST_FIRST_NAME"},"2":{"slot":2,"type":"STRING","value":"master_CUST_FIRST_NAME"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CUST_FIRST_NAME"},"2":{"slot":2,"type":"STRING","value":"compare_CUST_FIRST_NAME"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"master_CUST_LAST_NAME"},"2":{"slot":2,"type":"STRING","value":"master_CUST_LAST_NAME"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CUST_LAST_NAME"},"2":{"slot":2,"type":"STRING","value":"compare_CUST_LAST_NAME"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"master_FINAL_LEAD_SCORE_TIER"},"2":{"slot":2,"type":"STRING","value":"master_FINAL_LEAD_SCORE_TIER"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"compare_FINAL_LEAD_SCORE_TIER"},"2":{"slot":2,"type":"STRING","value":"compare_FINAL_LEAD_SCORE_TIER"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"master_DEAL_ID"},"2":{"slot":2,"type":"STRING","value":"master_DEAL_ID"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"compare_DEAL_ID"},"2":{"slot":2,"type":"STRING","value":"compare_DEAL_ID"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"master_DEAL_STAGE"},"2":{"slot":2,"type":"STRING","value":"master_DEAL_STAGE"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"compare_DEAL_STAGE"},"2":{"slot":2,"type":"STRING","value":"compare_DEAL_STAGE"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"master_REV_HIST_CHANGE_TYPE"},"2":{"slot":2,"type":"STRING","value":"master_REV_HIST_CHANGE_TYPE"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"compare_REV_HIST_CHANGE_TYPE"},"2":{"slot":2,"type":"STRING","value":"compare_REV_HIST_CHANGE_TYPE"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"master_REV_HIST_EVENT_TYPE"},"2":{"slot":2,"type":"STRING","value":"master_REV_HIST_EVENT_TYPE"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"compare_REV_HIST_EVENT_TYPE"},"2":{"slot":2,"type":"STRING","value":"compare_REV_HIST_EVENT_TYPE"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"master_REV_HIST_METADATA"},"2":{"slot":2,"type":"STRING","value":"master_REV_HIST_METADATA"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"compare_REV_HIST_METADATA"},"2":{"slot":2,"type":"STRING","value":"compare_REV_HIST_METADATA"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"master_REV_HIST_OCCURRED_DT"},"2":{"slot":2,"type":"STRING","value":"master_REV_HIST_OCCURRED_DT"}}},"24":{"slot":24,"values":{"1":{"slot":1,"type":"STRING","value":"compare_REV_HIST_OCCURRED_DT"},"2":{"slot":2,"type":"STRING","value":"compare_REV_HIST_OCCURRED_DT"}}},"25":{"slot":25,"values":{"1":{"slot":1,"type":"STRING","value":"compare_EVENT_OCCURRENCE_ORDER"},"2":{"slot":2,"type":"STRING","value":"compare_EVENT_OCCURRENCE_ORDER"}}}},"visible":true},"6":{"slot":6,"name":"Indicator Column","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Indicator"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"59153":{"id":59153,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":208,"y":118,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[59169],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BPF_CUST_FNNL_REV_HIST 0"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BPF_CUST_FNNL_REV_HIST"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CUST_ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CUST_KEY"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"CUST_EMAIL"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"CUST_FIRST_NAME"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"CUST_LAST_NAME"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"FINAL_LEAD_SCORE_TIER"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"DEAL_ID"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"DEAL_STAGE"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"REV_HIST_CHANGE_TYPE"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"REV_HIST_EVENT_TYPE"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"REV_HIST_METADATA"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"REV_HIST_OCCURRED_DT"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"INSERT_DT"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"UPDATE_DT"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PUBLIC"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BPF_DATAMART"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"59184":{"id":59184,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":730,"y":4,"width":32,"height":32,"inputConnectorIDs":[59185],"outputConnectorIDs":[59188],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Filter 0"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Indicator"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"N"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"59169":{"id":59169,"sourceID":59153,"targetID":59130},"59176":{"id":59176,"sourceID":58967,"targetID":59130},"59180":{"id":59180,"sourceID":59130,"targetID":58483},"59185":{"id":59185,"sourceID":58483,"targetID":59184},"59188":{"id":59188,"sourceID":59184,"targetID":58503}},"notes":{},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"BPF_CUSTFNTL_REV_HIST","description":null,"type":"TRANSFORMATION","tag":"060c4bbd-695e-4536-b4e4-7c8dc990121b"}}