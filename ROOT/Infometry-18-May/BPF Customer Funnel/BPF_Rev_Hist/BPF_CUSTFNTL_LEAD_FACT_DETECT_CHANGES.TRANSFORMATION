{"job":{"components":{"29993":{"id":29993,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":-128,"y":80,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[29999],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_ODS_LEAD"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT \nTREE_KEY,\n SALE_PERSON_KEY,\nCUST_KEY,\n FOREST_KEY,\n\tLEAD_ID::varchar as Lead_id,\n\tCONTACT_EMAIL,\n\tCUSTOMER_FIRST_NAME,\n\tCUSTOMER_LAST_NAME,\n\tCONTACT_NAME,\n\tLEAD_SCORE::varchar AS LEAD_SCORE,\n\tDEAL_PIPELINE::varchar(500) DEAL_PIPELINE,\n\tLEAD_DEAL_ID::varchar as LEAD_DEAL_ID,   \n\tODS_LEAD.PREFERRED_FOREST,\n\tREGIONAL_DEPOSIT_FOREST,\n\tDEAL_FOREST,    \n\tTOUR_SCHEDULED_FOREST::varchar(500)AS TOUR_SCHEDULED_FOREST,\n\tTOUR_HELD_FOREST,\n\tTOUR_HELD_FOREST_STEWARD,\n\tTOUR_HELD_CHANNEL,\n\t--TOUR_FOREST,\n    CONTRACT_ID::varchar(500) LEAD_CONTRACT_ID,\n\tCONTRACT_FOREST,\n\tCONTRACT_CHANNEL,\n\tCONTRACT_VALUE::varchar(500) CONTRACT_VALUE,\n\tARBOR_TAG_ID,\n\tLEAD_STAGE,\n\tDEAL_CLOSED_TIMESTAMP,\n\tSALES_REP_NAME,\n\tSALES_REP_EMAIL,\n\tSDR_NAME,\n    SALES_REP_ID,\n\tPROJECTED_DEAL_AMOUNT::varchar AS PROJECTED_DEAL_AMOUNT,\n\tTOUR_SCHEDULED_CHANNEL,\n\t--TOUR_CHANNEL,\n\tDEPOSIT_TYPE,\n\tPITCH_SCHEDULE_TYPE,\n\t--FOREST,\n\tODS_LEAD.TREE_ID::varchar AS TREE_ID ,\n\tCONTACT_CREATED_dt,\n\tCASE WHEN YEAR(sales_lead_mql_timestamp) = '9999'  THEN NULL ELSE sales_lead_mql_timestamp END AS sales_lead_mql_timestamp,\n\tCASE WHEN YEAR(pitch_scheduled_dt) = '9999' THEN NULL ELSE pitch_scheduled_dt END AS pitch_scheduled_dt,\n\tODS_LEAD.SQL_TIMESTAMP,\n\tCASE WHEN YEAR(pitch_held_dt) = '9999' THEN NULL ELSE pitch_held_dt END AS pitch_held_dt,\n\tDEPOSIT_TIMESTAMP,\n    CASE WHEN YEAR(tour_scheduled_dt) = '9999' THEN NULL ELSE tour_scheduled_dt END AS tour_scheduled_dt,\n    CASE WHEN YEAR(tour_held_dt) = '9999' THEN NULL ELSE tour_held_dt END AS tour_held_dt,\n\tCONTRACT_SIGNED_Dt,\n    NULL UPDATE_DATE,\n    1 AS IS_LATEST\n    FROM \n(\nselect \n\tCUSTOMER_ID::varchar AS LEAD_ID,\n\tCONTACT_EMAIL,\n\tCUSTOMER_FIRST_NAME,\n\tCUSTOMER_LAST_NAME,\n\tCONTACT_NAME,\n\tOL.FINAL_LEAD_SCORE_TIER AS LEAD_SCORE,\n\tDEAL_PIPELINE::varchar(500) DEAL_PIPELINE,\n\tDEAL_ID AS LEAD_DEAL_ID,   \n\tOL.PREFERRED_FOREST,\n\tREGIONAL_DEPOSIT_FOREST,\n\tDEAL_FOREST,    \n\tTOUR_SCHEDULED_FOREST::varchar(500)AS TOUR_SCHEDULED_FOREST,\n\tTOUR_HELD_FOREST,\n\tTOUR_HELD_FOREST_STEWARD,\n\tTOUR_HELD_CHANNEL,\n\t--TOUR_FOREST,\n    CONTRACT_ID::varchar(500) CONTRACT_ID,\n\tCONTRACT_FOREST,\n\tCONTRACT_CHANNEL,\n\tCONTRACT_VALUE::varchar(500) CONTRACT_VALUE,\n\tARBOR_TAG_ID,\n\tDEAL_STAGE AS LEAD_STAGE,\n\tDEAL_CLOSED_TIMESTAMP,\n\tSALES_REP_NAME,\n\tSALES_REP_EMAIL,\n\tSDR_NAME,\n     SALES_REP_ID,\n\tPROJECTED_DEAL_AMOUNT,\n\tTOUR_SCHEDULED_CHANNEL,\n\t--TOUR_CHANNEL,\n\tDEPOSIT_TYPE,\n\tPITCH_SCHEDULE_TYPE,\n\t--FOREST,\n\tOL.TREE_ID,\n\tCONTACT_CREATED_DT,\n\t'9999-01-01' AS MAX_DT,\n\t'9999-12-31 13:30:00' AS COMP_DT,\n\t\n\tIFNULL(SALES_LEAD_MQL_TIMESTAMP,TO_TIMESTAMP_NTZ(MAX_DT)) SALES_LEAD_MQL_TIMESTAMP1,\n\tIFNULL(pitch_scheduled_dt,TO_TIMESTAMP_NTZ(MAX_DT)) pitch_scheduled1,\n\tIFNULL(pitch_held_dt,TO_TIMESTAMP_NTZ(MAX_DT)) pitch_held1,\n\tIFNULL(tour_scheduled_dt,TO_TIMESTAMP_NTZ(MAX_DT))tour_scheduled1,\n\tIFNULL(tour_held_dt,TO_TIMESTAMP_NTZ(MAX_DT)) tour_held1 ,\n\tIFNULL(contract_signed_dt,TO_TIMESTAMP_NTZ(MAX_DT)) contract_signed1,\n\t\n\tleast(sales_lead_mql_timestamp1,pitch_scheduled1, pitch_held1,tour_scheduled1, tour_held1, contract_signed1) as sales_lead_mql_timestamp,\n    \n   least(pitch_scheduled1, pitch_held1, tour_scheduled1, tour_held1, contract_signed1) AS pitch_scheduled_dt,\n   \tOL.SQL_TIMESTAMP,\n\t--PITCH_HELD,\n    least(pitch_held1,tour_scheduled1, tour_held1, contract_signed1) as pitch_held_dt,\n\tDEPOSIT_TIMESTAMP,\n\t--TOUR_SCHEDULED,\n    least(tour_scheduled1, tour_held1, contract_signed1)AS  tour_scheduled_dt,\n\t--TOUR_HELD,\n    least(tour_held1, contract_signed1) AS tour_held_dt,\n\tCONTRACT_SIGNED_dt,\n    NULL UPDATE_DATE,\n    1 AS IS_LATEST\nfrom \n--customer_funnel_no_backfill CF\nBPF_ODS.\"PUBLIC\".ODS_LEAD OL\n -- BPF_ODS.\"PUBLIC\".ODS_LEAD_TEST OL\n) \nODS_LEAD \nLEFT OUTER JOIN\nBPF_DATAMART.\"PUBLIC\".DIM_CUSTOMER  C\nON CAST(ODS_LEAD.LEAD_ID AS VARCHAR) = CAST(C.CUST_ID AS VARCHAR)\nLEFT OUTER JOIN \nBPF_DATAMART.\"PUBLIC\".DIM_SALES_PERSON S\nON CAST(ODS_LEAD.SALES_REP_ID AS VARCHAR) = CAST(S.SALES_PERSON_ID AS VARCHAR)\nLEFT OUTER JOIN \nBPF_DATAMART.\"PUBLIC\".DIM_FOREST F\nON CAST(ODS_LEAD.DEAL_FOREST AS VARCHAR(500)) = CAST(F.FOREST_FULLNAME AS VARCHAR(500))\nLEFT OUTER JOIN BPF_DATAMART.\"PUBLIC\".DIM_TREE_PRODUCT T\nON CAST(ODS_LEAD.TREE_ID AS VARCHAR) =CAST(T.TREE_ID AS VARCHAR)\n"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"29994":{"id":29994,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":208,"y":80,"width":32,"height":32,"inputConnectorIDs":[30002],"outputConnectorIDs":[29951],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"E_FACT_LEAD"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TO_TIMESTAMP_NTZ(CURRENT_TIMESTAMP(9))"},"2":{"slot":2,"type":"STRING","value":"C_INSERT_UPD_DATE"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CONCAT(\"LEAD_ID\",'~',\"SRC_LEAD_DEAL_ID\",'~',\"SRC_LEAD_CONTRACT_ID\",'~',\"SRC_CONTACT_CREATED_DT\")"},"2":{"slot":2,"type":"STRING","value":"C_UNQ_KEY"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(to_number(to_char(\"SRC_PITCH_SCHEDULED_DT\",'YYYYMMDD'),'99999999'),0)"},"2":{"slot":2,"type":"STRING","value":"C_PTCH_SCHD_DT_KEY"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(to_number(to_char(\"SRC_TOUR_SCHEDULED_DT\",'YYYYMMDD'),'99999999'),0)"},"2":{"slot":2,"type":"STRING","value":"C_TOUR_SCHD_DT_KEY"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_CONTACT_EMAIL\",'NA')"},"2":{"slot":2,"type":"STRING","value":"C_EMAIL"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"\"SRC_LEAD_STAGE\""},"2":{"slot":2,"type":"STRING","value":"C_STG"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_LEAD_ID\",'NA')"},"2":{"slot":2,"type":"STRING","value":"C_LEAD_ID"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_CUSTOMER_FIRST_NAME\",'NA')"},"2":{"slot":2,"type":"STRING","value":"C_FN"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_CUSTOMER_LAST_NAME\",'NA')"},"2":{"slot":2,"type":"STRING","value":"C_LN"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_CONTACT_NAME\",'NA')"},"2":{"slot":2,"type":"STRING","value":"C_FULLNM"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"\"SRC_LEAD_SCORE\""},"2":{"slot":2,"type":"STRING","value":"C_SCORE"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_DEAL_PIPELINE\",'NA')"},"2":{"slot":2,"type":"STRING","value":"C_PIPLN"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"\"SRC_LEAD_DEAL_ID\"\n--IFNULL(\"SRC_DEAL_ID\",'NA')"},"2":{"slot":2,"type":"STRING","value":"C_DEAL_ID"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_PREFERRED_FOREST\",'NA')"},"2":{"slot":2,"type":"STRING","value":"C_DEAL_PRFD_FOREST"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_DEAL_FOREST\",'NA')"},"2":{"slot":2,"type":"STRING","value":"C_DEAL_FOREST"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_TOUR_SCHEDULED_FOREST\",'NA')"},"2":{"slot":2,"type":"STRING","value":"C_TOUR_SCHD_FOR"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"\"SRC_LEAD_CONTRACT_ID\"\n--IFNULL(\"SRC_CONTRACT_ID\",0)"},"2":{"slot":2,"type":"STRING","value":"C_CNTRCT_ID"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_CONTRACT_VALUE\",0)"},"2":{"slot":2,"type":"STRING","value":"C_CONTRCT_VALUE"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(to_number(to_char(\"SRC_CONTRACT_SIGNED_DT\",'YYYYMMDD'),'99999999'),0)"},"2":{"slot":2,"type":"STRING","value":"C_CNTRCT_SGNED_DT_KEY"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(to_number(to_char(\"SRC_TOUR_HELD_DT\",'YYYYMMDD'),'99999999'),0)"},"2":{"slot":2,"type":"STRING","value":"C_TOUR_HELD_DT_KEY"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(to_number(to_char(\"SRC_DEPOSIT_TIMESTAMP\",'YYYYMMDD'),'99999999'),0)"},"2":{"slot":2,"type":"STRING","value":"C_DEPOST_DT_KEY"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(to_number(to_char(\"SRC_PITCH_HELD_DT\",'YYYYMMDD'),'99999999'),0)"},"2":{"slot":2,"type":"STRING","value":"C_PTCH_HELD_DT_KEY"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(to_number(to_char(\"SRC_SQL_TIMESTAMP\",'YYYYMMDD'),'99999999'),0)"},"2":{"slot":2,"type":"STRING","value":"C_SQL_DT_KEY"}}},"24":{"slot":24,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(to_number(to_char(\"SRC_SALES_LEAD_MQL_TIMESTAMP\",'YYYYMMDD'),'99999999'),0)"},"2":{"slot":2,"type":"STRING","value":"C_SALES_LEAD_MQL_DT_KEY"}}},"25":{"slot":25,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(to_number(to_char(\"SRC_CONTRACT_SIGNED_DT\",'YYYYMMDD'),'99999999'),0)"},"2":{"slot":2,"type":"STRING","value":"C_CNTRCT_CRED_DT_KEY"}}},"26":{"slot":26,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_PITCH_SCHEDULE_TYPE\",'NA')"},"2":{"slot":2,"type":"STRING","value":"C_PTCH_SCHD_TYP"}}},"27":{"slot":27,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_DEPOSIT_TYPE\",'NA')"},"2":{"slot":2,"type":"STRING","value":"C_DEPST_TYP"}}},"28":{"slot":28,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_TOUR_SCHEDULED_CHANNEL\",'NA')"},"2":{"slot":2,"type":"STRING","value":"C_TOUR_SCHD_CHNL"}}},"29":{"slot":29,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_PROJECTED_DEAL_AMOUNT\",0.00)"},"2":{"slot":2,"type":"STRING","value":"C_PRJCD_DEAL_AMNT"}}},"30":{"slot":30,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_SDR_NAME\",'NA')"},"2":{"slot":2,"type":"STRING","value":"C_SDR_NAME"}}},"31":{"slot":31,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_SALES_REP_NAME\",'NA')"},"2":{"slot":2,"type":"STRING","value":"C_SALES_REP_NM"}}},"32":{"slot":32,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(to_number(to_char(\"SRC_DEAL_CLOSED_TIMESTAMP\",'YYYYMMDD'),'99999999'),0)\n\n"},"2":{"slot":2,"type":"STRING","value":"C_DEAL_CLSD_DT_KEY"}}},"33":{"slot":33,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(to_number(to_char(\"SRC_CONTACT_CREATED_DT\",'YYYYMMDD'),'99999999'),0)"},"2":{"slot":2,"type":"STRING","value":"C_LEAD_CRED_DT_KEY"}}},"34":{"slot":34,"values":{"1":{"slot":1,"type":"STRING","value":"1"},"2":{"slot":2,"type":"STRING","value":"C_DEFAULT_1"}}},"35":{"slot":35,"values":{"1":{"slot":1,"type":"STRING","value":"0"},"2":{"slot":2,"type":"STRING","value":"C_DEFAULT_0"}}},"36":{"slot":36,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_TREE_KEY\",0)"},"2":{"slot":2,"type":"STRING","value":"C_TREE_KEY"}}},"37":{"slot":37,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_SALE_PERSON_KEY\",0)"},"2":{"slot":2,"type":"STRING","value":"C_SALES_PRSN_KEY"}}},"38":{"slot":38,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_PROJECTED_DEAL_AMOUNT\",0)"},"2":{"slot":2,"type":"STRING","value":"C_DEAL_AMNT"}}},"39":{"slot":39,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(\"SRC_CUST_KEY\",0)"},"2":{"slot":2,"type":"STRING","value":"C_CUST_KEY"}}},"40":{"slot":40,"values":{"1":{"slot":1,"type":"STRING","value":"IFNULL(to_number(to_char(\"SRC_SALES_LEAD_MQL_TIMESTAMP\",'YYYYMMDD'),'99999999'),0)"},"2":{"slot":2,"type":"STRING","value":"C_SALES_MQL_DT_KEY"}}},"41":{"slot":41,"values":{"1":{"slot":1,"type":"STRING","value":"\"SRC_FOREST_KEY\""},"2":{"slot":2,"type":"STRING","value":"C_FOREST_KEY"}}},"42":{"slot":42,"values":{"1":{"slot":1,"type":"STRING","value":"\"TGT_LEAD_KEY\""},"2":{"slot":2,"type":"STRING","value":"C_LEAD_KEY"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"29995":{"id":29995,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":-128,"y":192,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[30000],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_TGT_FACT_LEAD"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"FACT_LEAD"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LEAD_KEY"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"LEAD_ID"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"LEAD_FIRST_NAME"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"LEAD_LAST_NAME"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"LEAD_EMAIL"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"LEAD_SCORE"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"LEAD_STAGE"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"PIPELINE"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"LEAD_DEAL_ID"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"LEAD_CONTRACT_VALUE"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"LEAD_DEAL_AMOUNT"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"CUST_KEY"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"SALES_PRSN_KEY"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"FOREST_KEY"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"TREE_KEY"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"SALES_LEAD_MQL_DT_KEY"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"LEAD_CREATED_DT_KEY"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"LEAD_SQL_CREATED_DT_KEY"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"LEAD_PITCH_DT_KEY"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"PITCH_SCHEDULED_DT_KEY"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"TOUR_SCHEDULED_DT_KEY"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"PITCH_HELD_DT_KEY"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"TOUR_HELD_DT_KEY"}}},"24":{"slot":24,"values":{"1":{"slot":1,"type":"STRING","value":"CONTRACT_SIGNED_DT_KEY"}}},"25":{"slot":25,"values":{"1":{"slot":1,"type":"STRING","value":"INSERT_DATE"}}},"26":{"slot":26,"values":{"1":{"slot":1,"type":"STRING","value":"UPDATE_DATE"}}},"27":{"slot":27,"values":{"1":{"slot":1,"type":"STRING","value":"IS_LATEST"}}},"28":{"slot":28,"values":{"1":{"slot":1,"type":"STRING","value":"UNIQUE_KEY"}}},"29":{"slot":29,"values":{"1":{"slot":1,"type":"STRING","value":"LEAD_CONTRACT_ID"}}},"30":{"slot":30,"values":{"1":{"slot":1,"type":"STRING","value":"PITCH_SCHEDULED_TYPE"}}},"31":{"slot":31,"values":{"1":{"slot":1,"type":"STRING","value":"SDR_NAME"}}},"32":{"slot":32,"values":{"1":{"slot":1,"type":"STRING","value":"TOUR_SCHEDULED_FOREST"}}},"33":{"slot":33,"values":{"1":{"slot":1,"type":"STRING","value":"TOUR_SCHEDULED_CHANNEL"}}},"34":{"slot":34,"values":{"1":{"slot":1,"type":"STRING","value":"TOUR_HELD_FOREST"}}},"35":{"slot":35,"values":{"1":{"slot":1,"type":"STRING","value":"TOUR_HELD_CHANNEL"}}},"36":{"slot":36,"values":{"1":{"slot":1,"type":"STRING","value":"TOUR_HELD_FOREST_STEWARD"}}},"37":{"slot":37,"values":{"1":{"slot":1,"type":"STRING","value":"CONTRACT_FOREST"}}},"38":{"slot":38,"values":{"1":{"slot":1,"type":"STRING","value":"CONTRACT_CHANNEL"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PUBLIC"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BPF_DATAMART"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"29996":{"id":29996,"inputCardinality":"TWO","outputCardinality":"MANY","implementationID":-359894709,"x":48,"y":80,"width":32,"height":32,"inputConnectorIDs":[29999,30000],"outputConnectorIDs":[30002],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SCD-2"}}}},"visible":true},"2":{"slot":2,"name":"Master Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_TGT_FACT_LEAD"}}}},"visible":true},"3":{"slot":3,"name":"Match Keys","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LEAD_ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"LEAD_DEAL_ID"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"LEAD_CONTRACT_ID"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"IS_LATEST"}}}},"visible":true},"4":{"slot":4,"name":"Compare Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LEAD_STAGE"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"LEAD_SCORE"}}}},"visible":true},"5":{"slot":5,"name":"Output Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"master_LEAD_ID"},"2":{"slot":2,"type":"STRING","value":"master_LEAD_ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"master_LEAD_DEAL_ID"},"2":{"slot":2,"type":"STRING","value":"master_LEAD_DEAL_ID"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"master_LEAD_CONTRACT_ID"},"2":{"slot":2,"type":"STRING","value":"master_LEAD_CONTRACT_ID"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"master_LEAD_KEY"},"2":{"slot":2,"type":"STRING","value":"TGT_LEAD_KEY"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"compare_TREE_KEY"},"2":{"slot":2,"type":"STRING","value":"SRC_TREE_KEY"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"compare_SALE_PERSON_KEY"},"2":{"slot":2,"type":"STRING","value":"SRC_SALE_PERSON_KEY"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CUST_KEY"},"2":{"slot":2,"type":"STRING","value":"SRC_CUST_KEY"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"compare_FOREST_KEY"},"2":{"slot":2,"type":"STRING","value":"SRC_FOREST_KEY"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CONTACT_EMAIL"},"2":{"slot":2,"type":"STRING","value":"SRC_CONTACT_EMAIL"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CUSTOMER_FIRST_NAME"},"2":{"slot":2,"type":"STRING","value":"SRC_CUSTOMER_FIRST_NAME"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CUSTOMER_LAST_NAME"},"2":{"slot":2,"type":"STRING","value":"SRC_CUSTOMER_LAST_NAME"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CONTACT_NAME"},"2":{"slot":2,"type":"STRING","value":"SRC_CONTACT_NAME"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"compare_LEAD_SCORE"},"2":{"slot":2,"type":"STRING","value":"SRC_LEAD_SCORE"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"compare_DEAL_PIPELINE"},"2":{"slot":2,"type":"STRING","value":"SRC_DEAL_PIPELINE"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"compare_PREFERRED_FOREST"},"2":{"slot":2,"type":"STRING","value":"SRC_PREFERRED_FOREST"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"compare_REGIONAL_DEPOSIT_FOREST"},"2":{"slot":2,"type":"STRING","value":"SRC_REGIONAL_DEPOSIT_FOREST"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"compare_DEAL_FOREST"},"2":{"slot":2,"type":"STRING","value":"SRC_DEAL_FOREST"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"compare_TOUR_SCHEDULED_FOREST"},"2":{"slot":2,"type":"STRING","value":"SRC_TOUR_SCHEDULED_FOREST"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CONTRACT_FOREST"},"2":{"slot":2,"type":"STRING","value":"SRC_CONTRACT_FOREST"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CONTRACT_VALUE"},"2":{"slot":2,"type":"STRING","value":"SRC_CONTRACT_VALUE"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"compare_ARBOR_TAG_ID"},"2":{"slot":2,"type":"STRING","value":"SRC_ARBOR_TAG_ID"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"compare_LEAD_STAGE"},"2":{"slot":2,"type":"STRING","value":"SRC_LEAD_STAGE"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"compare_DEAL_CLOSED_TIMESTAMP"},"2":{"slot":2,"type":"STRING","value":"SRC_DEAL_CLOSED_TIMESTAMP"}}},"24":{"slot":24,"values":{"1":{"slot":1,"type":"STRING","value":"compare_SALES_REP_NAME"},"2":{"slot":2,"type":"STRING","value":"SRC_SALES_REP_NAME"}}},"25":{"slot":25,"values":{"1":{"slot":1,"type":"STRING","value":"compare_SDR_NAME"},"2":{"slot":2,"type":"STRING","value":"SRC_SDR_NAME"}}},"26":{"slot":26,"values":{"1":{"slot":1,"type":"STRING","value":"compare_SALES_REP_ID"},"2":{"slot":2,"type":"STRING","value":"SRC_SALES_REP_ID"}}},"27":{"slot":27,"values":{"1":{"slot":1,"type":"STRING","value":"compare_PROJECTED_DEAL_AMOUNT"},"2":{"slot":2,"type":"STRING","value":"SRC_PROJECTED_DEAL_AMOUNT"}}},"28":{"slot":28,"values":{"1":{"slot":1,"type":"STRING","value":"compare_TOUR_SCHEDULED_CHANNEL"},"2":{"slot":2,"type":"STRING","value":"SRC_TOUR_SCHEDULED_CHANNEL"}}},"29":{"slot":29,"values":{"1":{"slot":1,"type":"STRING","value":"compare_DEPOSIT_TYPE"},"2":{"slot":2,"type":"STRING","value":"SRC_DEPOSIT_TYPE"}}},"30":{"slot":30,"values":{"1":{"slot":1,"type":"STRING","value":"compare_PITCH_SCHEDULE_TYPE"},"2":{"slot":2,"type":"STRING","value":"SRC_PITCH_SCHEDULE_TYPE"}}},"31":{"slot":31,"values":{"1":{"slot":1,"type":"STRING","value":"compare_TREE_ID"},"2":{"slot":2,"type":"STRING","value":"SRC_TREE_ID"}}},"32":{"slot":32,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CONTACT_CREATED_DT"},"2":{"slot":2,"type":"STRING","value":"SRC_CONTACT_CREATED_DT"}}},"33":{"slot":33,"values":{"1":{"slot":1,"type":"STRING","value":"compare_SALES_LEAD_MQL_TIMESTAMP"},"2":{"slot":2,"type":"STRING","value":"SRC_SALES_LEAD_MQL_TIMESTAMP"}}},"34":{"slot":34,"values":{"1":{"slot":1,"type":"STRING","value":"compare_PITCH_SCHEDULED_DT"},"2":{"slot":2,"type":"STRING","value":"SRC_PITCH_SCHEDULED_DT"}}},"35":{"slot":35,"values":{"1":{"slot":1,"type":"STRING","value":"compare_SQL_TIMESTAMP"},"2":{"slot":2,"type":"STRING","value":"SRC_SQL_TIMESTAMP"}}},"36":{"slot":36,"values":{"1":{"slot":1,"type":"STRING","value":"compare_PITCH_HELD_DT"},"2":{"slot":2,"type":"STRING","value":"SRC_PITCH_HELD_DT"}}},"37":{"slot":37,"values":{"1":{"slot":1,"type":"STRING","value":"compare_DEPOSIT_TIMESTAMP"},"2":{"slot":2,"type":"STRING","value":"SRC_DEPOSIT_TIMESTAMP"}}},"38":{"slot":38,"values":{"1":{"slot":1,"type":"STRING","value":"compare_TOUR_SCHEDULED_DT"},"2":{"slot":2,"type":"STRING","value":"SRC_TOUR_SCHEDULED_DT"}}},"39":{"slot":39,"values":{"1":{"slot":1,"type":"STRING","value":"compare_TOUR_HELD_DT"},"2":{"slot":2,"type":"STRING","value":"SRC_TOUR_HELD_DT"}}},"40":{"slot":40,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CONTRACT_SIGNED_DT"},"2":{"slot":2,"type":"STRING","value":"SRC_CONTRACT_SIGNED_DT"}}},"41":{"slot":41,"values":{"1":{"slot":1,"type":"STRING","value":"compare_LEAD_ID"},"2":{"slot":2,"type":"STRING","value":"SRC_LEAD_ID"}}},"42":{"slot":42,"values":{"1":{"slot":1,"type":"STRING","value":"compare_LEAD_CONTRACT_ID"},"2":{"slot":2,"type":"STRING","value":"SRC_CONTRACT_ID"}}},"43":{"slot":43,"values":{"1":{"slot":1,"type":"STRING","value":"compare_IS_LATEST"},"2":{"slot":2,"type":"STRING","value":"SRC_IS_LATEST"}}},"44":{"slot":44,"values":{"1":{"slot":1,"type":"STRING","value":"compare_TOUR_HELD_FOREST"},"2":{"slot":2,"type":"STRING","value":"SRC_TOUR_HELD_FOREST"}}},"45":{"slot":45,"values":{"1":{"slot":1,"type":"STRING","value":"compare_TOUR_HELD_FOREST_STEWARD"},"2":{"slot":2,"type":"STRING","value":"SRC_TOUR_HELD_FOREST_STEWARD"}}},"46":{"slot":46,"values":{"1":{"slot":1,"type":"STRING","value":"compare_TOUR_HELD_CHANNEL"},"2":{"slot":2,"type":"STRING","value":"SRC_TOUR_HELD_CHANNEL"}}},"47":{"slot":47,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CONTRACT_CHANNEL"},"2":{"slot":2,"type":"STRING","value":"SRC_CONTRACT_CHANNEL"}}},"48":{"slot":48,"values":{"1":{"slot":1,"type":"STRING","value":"compare_LEAD_DEAL_ID"},"2":{"slot":2,"type":"STRING","value":"SRC_LEAD_DEAL_ID"}}},"49":{"slot":49,"values":{"1":{"slot":1,"type":"STRING","value":"compare_LEAD_CONTRACT_ID"},"2":{"slot":2,"type":"STRING","value":"SRC_LEAD_CONTRACT_ID"}}}},"visible":true},"6":{"slot":6,"name":"Indicator Column","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SCD-FLAG"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"29997":{"id":29997,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":335239555,"x":480,"y":80,"width":32,"height":32,"inputConnectorIDs":[30001],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stg_FACT_LEAD"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stg_FACT_LEAD"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BPF_DATAMART"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PUBLIC"}}}},"visible":true},"8":{"slot":8,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BPF_SMALL"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"29998":{"id":29998,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":336,"y":80,"width":32,"height":32,"inputConnectorIDs":[29951],"outputConnectorIDs":[30001],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Filter 0"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SCD-FLAG"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"C"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"SCD-FLAG"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"N"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"OR"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"29951":{"id":29951,"sourceID":29994,"targetID":29998},"29999":{"id":29999,"sourceID":29993,"targetID":29996},"30000":{"id":30000,"sourceID":29995,"targetID":29996},"30001":{"id":30001,"sourceID":29998,"targetID":29997},"30002":{"id":30002,"sourceID":29996,"targetID":29994}},"notes":{"29992":{"id":29992,"x":-197,"y":8,"width":726,"height":223,"text":"FACT_LEAD","colour":"e6e63c"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"BPF_CUSTFNTL_LEAD_FACT_DETECT_CHANGES","description":"","type":"TRANSFORMATION","tag":"5d572e26-946a-4b9a-a973-a079257bd735"}}