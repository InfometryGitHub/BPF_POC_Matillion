{"job":{"components":{"12669":{"id":12669,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":292,"y":142,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[12707],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_ODS_PTCH_SCHD"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT\n\tCUSTOMER_ID,\n\tEMAIL,\n\tCREATED_AT,\n\tEVENT_TYPE,\n\tCANCELED,\n\tCONFIRMED,\n\tFOLLOW_UP_SENT,\n\tREMINDER1_SENT,\n\tREMINDER2_SENT,\n\tREMINDER3_SENT,\n\tUTM_SOURCE,\n\tUTM_TERM,\n\tUTM_CAMPAIGN,\n\tUTM_CONTENT,\n\tUTM_MEDIUM,\n\tPITCH_SCHEDULED_TIMESTAMP,\n\tPITCH_SCHEDULED_HOUR,\n\tPITCH_SCHEDULED_DOW,\n\tPITCH_OWNER,\n\tPHONE_NUMBER,\n\tCUSTOM_SOURCE,\n\tPITCH_SCHEDULE_TYPE,\n\tEVENT_NUMBER,\n\tINSERT_DT,\n\tUPDATE_DT\nFROM\n\tBPF_ODS.\"PUBLIC\".VW_SRC_ODS_PITCH_SCHEDULED\n\n\n\n/*SELECT * FROM \n(\nwith pitch_scheduled as (\nselect \nNVL(id.customer_id::varchar ,NULL) customer_id\n,trim(lower(events.email)) as email\n--,convert_timezone('US/Pacific',events.created_at) as created_at\n,convert_timezone('America/New_York','America/Los_Angeles',events.created_at::timestamp_ntz) AS created_at\n\n,case when events.event_type = 'AppointletScheduleMeeting' THEN 'Scheduled'\nwhen events.event_type = 'AppointletRescheduledMeeting' THEN 'Rescheduled'\nwhen events.event_type = 'AppointletCanceledMeeting' THEN 'Canceled'\nelse event_type\nend as event_type\n,metadata\n\n-- Added May 18 2020\n,json_extract_path_text(metadata, 'meeting_date') as pitch_scheduled_unix\n,case when pitch_scheduled_unix = '' then null else dateadd(ms,cast(pitch_scheduled_unix AS int), CAST('1970-01-01 00:00:00' AS timestamp)) end as pitch_scheduled_timestamp_old\n,case when json_extract_path_text(metadata, 'start') = '' then null else convert_timezone('US/Pacific',cast(json_extract_path_text(metadata, 'start') as timestamp)) end as pitch_scheduled_timestamp_new\n\n,coalesce(pitch_scheduled_timestamp_new, pitch_scheduled_timestamp_old) as pitch_scheduled_timestamp\n,json_extract_path_text(metadata, 'meeting_time') as pitch_scheduled_hour_old\n,to_char(pitch_scheduled_timestamp_new, 'HH12:MI AM') as pitch_scheduled_hour_new\n\n,coalesce(pitch_scheduled_hour_new, pitch_scheduled_hour_old) as pitch_scheduled_hour\n\n,date_trunc('day',cast(pitch_scheduled_timestamp as timestamp)) as pitch_scheduled_day\n\n,case \nwhen extract(dow from pitch_scheduled_day) = 1 THEN 'Monday'\nwhen extract(dow from pitch_scheduled_day) = 2 THEN 'Tuesday'\nwhen extract(dow from pitch_scheduled_day) = 3 THEN 'Wednesday'\nwhen extract(dow from pitch_scheduled_day) = 4 THEN 'Thursday'\nwhen extract(dow from pitch_scheduled_day) = 5 THEN 'Friday'\nelse null end as pitch_scheduled_dow\n\n,json_extract_path_text(metadata, 'appointment_booked_calendar_owner') as appointment_booked_calendar_owner_old\n,json_extract_path_text(metadata, 'bookable_name') as pitch_owner_new\n,coalesce(pitch_owner_new, appointment_booked_calendar_owner_old) as pitch_owner\n\n-- **,json_extract_path_text(json_extract_array_element_text(json_extract_path_text(metadata, 'fields'),0),'value') as phone_number\n\n,position('\"value\":', events.metadata,1) as phone_number_pos\n,case when phone_number_pos = 0 then null else right(events.metadata, len(events.metadata) - phone_number_pos - len('\"value\":') - 13) end as post_phone_string\n,case when phone_number_pos = 0 then null else REPLACE(REPLACE(REPLACE(substring(events.metadata, phone_number_pos + len('\"value\":'), 13),'\"}',''),'\"',''),',','') end as phone_number\n\n--,json_extract_path_text(json_extract_array_element_text(json_extract_path_text(metadata, 'fields'),1),'value') as custom_source\n,position('\"value\":', post_phone_string,1) + phone_number_pos + len('\"value\":') as custom_source_pos\n,right(events.metadata, length(events.metadata) - custom_source_pos - len('\"value\":') - 12) as custom_source_string\n,REPLACE(REPLACE(replace(left(custom_source_string, position('\"field\"' in custom_source_string)),'\",{}',''),'\"',''),',','')as custom_source\n\n,case when created_at < '2/20/2020 19:43:22' then null\nwhen custom_source = 'personal' then 'AE-scheduled'\nwhen custom_source like 'sdr%' then 'SDR-scheduled'\nelse 'Self-scheduled'\nend as pitch_schedule_type\n--,json_extract_path_text(json_extract_array_element_text(json_extract_path_text(metadata, 'fields'),2),'value') as notes\n\n\n,json_extract_path_text(metadata, 'canceled') as canceled\n,json_extract_path_text(metadata, 'confirmed') as confirmed\n,json_extract_path_text(metadata, 'follow_up_sent') as follow_up_sent\n\n,json_extract_path_text(metadata, 'utm_source') as utm_source\n,json_extract_path_text(metadata, 'utm_term') as utm_term\n,json_extract_path_text(metadata, 'utm_campaign') as utm_campaign\n,json_extract_path_text(metadata, 'utm_content') as utm_content\n,json_extract_path_text(metadata, 'utm_medium') as utm_medium\n\n,json_extract_path_text(metadata, 'service_name') as service_name\n,json_extract_path_text(metadata, 'service_duration') as service_duration\n,json_extract_path_text(metadata, 'timezone') as timezone\n,json_extract_path_text(metadata, 'webhook') as webhook\n,json_extract_path_text(metadata, 'type') as appointlet_type\n\n,json_extract_path_text(metadata, 'reminder1_sent') as reminder1_sent\n,json_extract_path_text(metadata, 'reminder2_sent') as reminder2_sent\n,json_extract_path_text(metadata, 'reminder3_sent') as reminder3_sent\n\n--***************\n\n--REPLACE(case when position('canceled\":' , events.metadata,1) = 0 then null else substring(events.metadata, position('canceled\":' IN events.metadata) + (len('canceled\":')), 5) END,',','') as canceled\n--,REPLACE(case when position('confirmed\":' , events.metadata,1) = 0 then null else substring(events.metadata, position('confirmed\":' IN events.metadata) + (len('confirmed\":')), 5) end,',','') as confirmed\n--,REPLACE(case when position('follow_up_sent\":' , events.metadata,1) = 0 then null else substring(events.metadata, position('follow_up_sent\":' IN events.metadata) + (len('follow_up_sent\":')), 5) end,',','') as follow_up_sent\n\n\n--REPLACE(case when position('reminder1_sent\":' , events.metadata,1) = 0 then null else substring(events.metadata, position('reminder1_sent\":' IN events.metadata) + (len('reminder1_sent\":')), 5) end,',','') as reminder1_sent\n--,REPLACE(case when position('reminder2_sent\":' , events.metadata,1) = 0 then null else substring(events.metadata, position('reminder2_sent\":' IN events.metadata) + (len('reminder2_sent\":')), 5) end,',','') as reminder2_sent\n--,REPLACE(case when position('reminder3_sent\":' , events.metadata,1) = 0 then null else substring(events.metadata, position('reminder3_sent\":' IN events.metadata) + (len('reminder3_sent\":')), 5) end,',','')as reminder3_sent\n\n\n--,case \n--when position('utm_source\":',events.metadata,1) = 0 then null \n--when substring(events.metadata, position('utm_source\":',events.metadata,1) + (len('utm_source\":')),5) = 'null' then null\n--else substring(events.metadata, position('utm_source\":',events.metadata,1) + (len('utm_source\":\"')), position('\"utm_term\":',events.metadata,1) - position('utm_source\":',events.metadata,1) - 15) \n--end as utm_source\n\n--,case \n--when position('utm_term\":',events.metadata,1) = 0 then null \n--when REPLACE(substring(events.metadata, position('utm_term\":',events.metadata,1) + (len('utm_term\":')), 5),',','') = 'null' then null\n--else substring(events.metadata, position('utm_term\":',events.metadata,1) + (len('utm_term\":\"')), position('\"reminder1_sent\":',events.metadata,1) - position('utm_term\":',events.metadata,1) - 13) \n--end as utm_term\n\n--,case \n--when position('utm_campaign\":',events.metadata,1) = 0 then null \n--when REPLACE(substring(events.metadata, position('utm_campaign\":' IN events.metadata) + (len('utm_campaign\":')), 5),',','') = 'null' then null\n--else substring(events.metadata, position('utm_campaign\":' , events.metadata,1) + (len('utm_campaign\":\"')), position('\"utm_content\":' , events.metadata,1) - position('utm_campaign\":' , events.metadata,1) - 17) \n--end as utm_campaign\n\n--,case \n--when position('utm_content\":' , events.metadata,1) = 0 then null \n--when REPLACE(substring(events.metadata, position('utm_content\":' , events.metadata,1) + (len('utm_content\":')), 5),',','') = 'null' then null\n--else substring(events.metadata, position('utm_content\":' , events.metadata,1) + (len('utm_content\":\"')), position('\"utm_medium\":' , events.metadata,1) - position('utm_content\":' , events.metadata,1) - 16) \n--end as utm_content\n\n\n--,case \n--when position('utm_medium\":' , events.metadata,1) = 0 then null \n--when REPLACE(substring(events.metadata, position('utm_medium\":' , events.metadata,1) + (len('utm_medium\":')), 5),',','') = 'null' then null\n--else substring(events.metadata, position('utm_medium\":' , events.metadata,1) + (len('utm_medium\":\"')), position('\"end\":' , events.metadata,1) - position('utm_medium\":' , events.metadata,1) - 15) \n--end as utm_medium\n\n/* **,case when position('meeting_date' , events.metadata,1) = 0 then null\nwhen event_type = 'AppointletScheduleMeeting' THEN substring(events.metadata, position('meeting_date' , events.metadata,1) + (len('meeting_date\":\"')), 13)\nwhen event_type = 'AppointletRescheduledMeeting' THEN substring(events.metadata, position('meeting_date' , events.metadata,1) + (len('meeting_date\":\"')), 13)\nELSE NULL\nend as pitch_scheduled_unix */\n\n--,coalesce(pitch_scheduled_timestamp_new, pitch_scheduled_timestamp_old) as pitch_scheduled_timestamp\n-- ***,dateadd(ms,cast(pitch_scheduled_unix AS int), CAST('1970-01-01 00:00:00' AS timestamp)) as pitch_scheduled_timestamp\n\n/* ***\n,REPLACE(case when position('meeting_time', events.metadata,1) = 0 then null\nwhen event_type = 'AppointletScheduleMeeting' THEN substring(events.metadata, position('meeting_time' , events.metadata,1) + (len('meeting_time\":\"')), 8)\nwhen event_type = 'AppointletRescheduledMeeting' THEN substring(events.metadata, position('meeting_time' , events.metadata,1) + (len('meeting_time\":\"')), 8)\nELSE NULL\nEND ,'\"','') as pitch_scheduled_hour */\n\n--,coalesce(pitch_scheduled_hour_new, pitch_scheduled_hour_old) as pitch_scheduled_hour\n\n--,case \n--when event_type = 'AppointletScheduleMeeting' and created_at between '2019-12-01' and '2020-02-20' THEN substring(events.metadata, position('appointment_booked_calendar_owner' , events.metadata,1) + len('appointment_booked_calendar_owner\":\"'), position('}' , events.metadata,1) - (position('appointment_booked_calendar_owner' , events.metadata,1) + len('appointment_booked_calendar_owner\":\"') + 1))\n--when event_type = 'AppointletScheduleMeeting' and created_at > '2020-02-20' and position('webhook' , events.metadata,1) != 0 THEN substring(events.metadata, position('bookable_name' , events.metadata,1) + len('bookable_name\":\"'), position('webhook' , events.metadata,1) - (position('bookable_name' , events.metadata,1) + len('bookable_name\":\"') + 3))\n--when event_type = 'AppointletRescheduledMeeting' and created_at between '2019-08-01' and '2020-03-09 23:59:59' THEN substring(events.metadata, position('appointment_booked_calendar_owner' , events.metadata,1) + len('appointment_booked_calendar_owner\":\"'), position('appointlet_reschedule_date' , events.metadata,1) - (position('appointment_booked_calendar_owner' , events.metadata,1) + len('appointment_booked_calendar_owner\":\"')+3))\n--when event_type = 'AppointletRescheduledMeeting' and created_at >= '2020-03-10' and position('webhook' , events.metadata,1) != 0 THEN substring(events.metadata, position('bookable_name' , events.metadata,1) + len('bookable_name\":\"'), position('webhook' , events.metadata,1) - (position('bookable_name' , events.metadata,1) + len('bookable_name\":\"') + 3))\n--ELSE NULL\n--end as pitch_owner\n\n--,case when phone_number_pos = 0 then null else REPLACE(REPLACE(REPLACE(substring(events.metadata, phone_number_pos + len('\"value\":'), 13),'\"}',''),'\"',''),',','') end as phone_number\n\n\n\n--,REPLACE(REPLACE(replace(left(custom_source_string, position('\"field\"' in custom_source_string)),'\",{}',''),'\"',''),',','')as custom_source\n/*\nfrom \n--bpf_robots.events events\nBPF_LANDING.\"PUBLIC\".BPF_ROBOTS_EVENTS AS events\nleft outer join \n--{{ @Customer_ID_Email_Association as id }} \nBPF_ODS.\"PUBLIC\".\"ODS_VALID_CUST _EMAILS\" AS id\non id.email = events.email\nwhere events.EVENT_TYPE  IN ('AppointletScheduleMeeting', 'AppointletRescheduledMeeting', 'AppointletCanceledMeeting')\n)\n\nselect \ncustomer_id,\nemail,\ncreated_at,\nevent_type,\ncanceled,\nconfirmed,\nfollow_up_sent,\nreminder1_sent,\nreminder2_sent,\nreminder3_sent,\nutm_source,\nutm_term,\nutm_campaign,\nutm_content,\nutm_medium,\npitch_scheduled_timestamp,\npitch_scheduled_hour,\npitch_scheduled_dow,\npitch_owner,\nphone_number,\ncustom_source,\ncase when created_at < '2/20/2020 19:43:22' then null\nwhen custom_source = 'personal' then 'AE-scheduled'\nwhen custom_source like 'sdr%' then 'SDR-scheduled'\nelse 'Self-scheduled'\nend as pitch_schedule_type,\nrow_number() over (partition by customer_id order by created_at asc) as event_number,\nCURRENT_TIMESTAMP()  AS insert_dt,\nNULL update_dt\nfrom pitch_scheduled\norder by created_at DESC\n) F_PTCH_SCHEDULED\nWHERE event_number=1*/"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"12670":{"id":12670,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":570,"y":143,"width":32,"height":32,"inputConnectorIDs":[12708],"outputConnectorIDs":[12706],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"E_ODS_PTCH_SCHD"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TO_TIMESTAMP_NTZ(CURRENT_TIMESTAMP(9))"},"2":{"slot":2,"type":"STRING","value":"C_INS_UPD_DT"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"12671":{"id":12671,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-1848704949,"x":810,"y":143,"width":32,"height":32,"inputConnectorIDs":[12705],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TGT_ODS_PTCH_SCHD"}}}},"visible":true},"200":{"slot":200,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_PITCH_SCHEDULED"}}}},"visible":true},"201":{"slot":201,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PUBLIC"}}}},"visible":true},"202":{"slot":202,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BPF_ODS"}}}},"visible":true},"203":{"slot":203,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BPF_SMALL"}}}},"visible":true},"204":{"slot":204,"name":"Target Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TGT"}}}},"visible":true},"205":{"slot":205,"name":"Source Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SRC"}}}},"visible":true},"206":{"slot":206,"name":"Join Expression","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"TGT\".\"CUSTOMER_ID\"=\"SRC\".\"CUSTOMER_ID\""},"2":{"slot":2,"type":"STRING","value":"Join"}}}},"visible":true},"207":{"slot":207,"name":"When Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"<none>"},"2":{"slot":2,"type":"STRING","value":"Update"}}}},"visible":true},"208":{"slot":208,"name":"Update Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"C_INS_UPD_DT"},"2":{"slot":2,"type":"STRING","value":"UPDATE_DT"}}}},"visible":true},"209":{"slot":209,"name":"Include Not Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"210":{"slot":210,"name":"Insert Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CUSTOMER_ID"},"2":{"slot":2,"type":"STRING","value":"CUSTOMER_ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_EMAIL"},"2":{"slot":2,"type":"STRING","value":"EMAIL"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_CRD_DT"},"2":{"slot":2,"type":"STRING","value":"CREATED_AT"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_EVNT_TYP"},"2":{"slot":2,"type":"STRING","value":"EVENT_TYPE"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_CNCLED"},"2":{"slot":2,"type":"STRING","value":"CANCELED"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_CONFRMD"},"2":{"slot":2,"type":"STRING","value":"CONFIRMED"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_FOLLWUP_SENT"},"2":{"slot":2,"type":"STRING","value":"FOLLOW_UP_SENT"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_RMDR_SEN1"},"2":{"slot":2,"type":"STRING","value":"REMINDER1_SENT"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_RMDR_SENT2"},"2":{"slot":2,"type":"STRING","value":"REMINDER2_SENT"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_RMDR_SENT3"},"2":{"slot":2,"type":"STRING","value":"REMINDER3_SENT"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_UTM_SOURCE"},"2":{"slot":2,"type":"STRING","value":"UTM_SOURCE"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_UTM_TERM"},"2":{"slot":2,"type":"STRING","value":"UTM_TERM"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_UTM_CMPGN"},"2":{"slot":2,"type":"STRING","value":"UTM_CAMPAIGN"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_UT_CNTNT"},"2":{"slot":2,"type":"STRING","value":"UTM_CONTENT"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_UTM_MDM"},"2":{"slot":2,"type":"STRING","value":"UTM_MEDIUM"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_PTCH_SCHD_DT"},"2":{"slot":2,"type":"STRING","value":"PITCH_SCHEDULED_TIMESTAMP"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_PTCH_SCHD_HR"},"2":{"slot":2,"type":"STRING","value":"PITCH_SCHEDULED_HOUR"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_PTCH_OWNR"},"2":{"slot":2,"type":"STRING","value":"PITCH_OWNER"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_PH_NBR"},"2":{"slot":2,"type":"STRING","value":"PHONE_NUMBER"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_CUSTOM_SRC"},"2":{"slot":2,"type":"STRING","value":"CUSTOM_SOURCE"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_PTCH_SCHD_TYP"},"2":{"slot":2,"type":"STRING","value":"PITCH_SCHEDULE_TYPE"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_EVNT_NBR"},"2":{"slot":2,"type":"STRING","value":"EVENT_NUMBER"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"C_INS_UPD_DT"},"2":{"slot":2,"type":"STRING","value":"INSERT_DT"}}},"24":{"slot":24,"values":{"1":{"slot":1,"type":"STRING","value":"SRC_PITCH_SCHEDULED_DOW"},"2":{"slot":2,"type":"STRING","value":"PITCH_SCHEDULED_DOW"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"12701":{"id":12701,"inputCardinality":"TWO","outputCardinality":"MANY","implementationID":-359894709,"x":442,"y":143,"width":32,"height":32,"inputConnectorIDs":[12704,12707],"outputConnectorIDs":[12708],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SCD-2"}}}},"visible":true},"2":{"slot":2,"name":"Master Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"REF_ODS_PTCH_SCHD"}}}},"visible":true},"3":{"slot":3,"name":"Match Keys","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CUSTOMER_ID"}}}},"visible":true},"4":{"slot":4,"name":"Compare Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CUSTOMER_ID"}}}},"visible":true},"5":{"slot":5,"name":"Output Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"master_CUSTOMER_ID"},"2":{"slot":2,"type":"STRING","value":"TGT_CUSTOMER_ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CUSTOMER_ID"},"2":{"slot":2,"type":"STRING","value":"SRC_CUSTOMER_ID"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"compare_EMAIL"},"2":{"slot":2,"type":"STRING","value":"SRC_EMAIL"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CREATED_AT"},"2":{"slot":2,"type":"STRING","value":"SRC_CRD_DT"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"compare_EVENT_TYPE"},"2":{"slot":2,"type":"STRING","value":"SRC_EVNT_TYP"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CANCELED"},"2":{"slot":2,"type":"STRING","value":"SRC_CNCLED"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CONFIRMED"},"2":{"slot":2,"type":"STRING","value":"SRC_CONFRMD"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"compare_FOLLOW_UP_SENT"},"2":{"slot":2,"type":"STRING","value":"SRC_FOLLWUP_SENT"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"compare_REMINDER1_SENT"},"2":{"slot":2,"type":"STRING","value":"SRC_RMDR_SEN1"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"compare_REMINDER2_SENT"},"2":{"slot":2,"type":"STRING","value":"SRC_RMDR_SENT2"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"compare_REMINDER3_SENT"},"2":{"slot":2,"type":"STRING","value":"SRC_RMDR_SENT3"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"compare_UTM_SOURCE"},"2":{"slot":2,"type":"STRING","value":"SRC_UTM_SOURCE"}}},"13":{"slot":13,"values":{"1":{"slot":1,"type":"STRING","value":"compare_UTM_TERM"},"2":{"slot":2,"type":"STRING","value":"SRC_UTM_TERM"}}},"14":{"slot":14,"values":{"1":{"slot":1,"type":"STRING","value":"compare_UTM_CAMPAIGN"},"2":{"slot":2,"type":"STRING","value":"SRC_UTM_CMPGN"}}},"15":{"slot":15,"values":{"1":{"slot":1,"type":"STRING","value":"compare_UTM_CONTENT"},"2":{"slot":2,"type":"STRING","value":"SRC_UT_CNTNT"}}},"16":{"slot":16,"values":{"1":{"slot":1,"type":"STRING","value":"compare_UTM_MEDIUM"},"2":{"slot":2,"type":"STRING","value":"SRC_UTM_MDM"}}},"17":{"slot":17,"values":{"1":{"slot":1,"type":"STRING","value":"compare_PITCH_SCHEDULED_TIMESTAMP"},"2":{"slot":2,"type":"STRING","value":"SRC_PTCH_SCHD_DT"}}},"18":{"slot":18,"values":{"1":{"slot":1,"type":"STRING","value":"compare_PITCH_SCHEDULED_HOUR"},"2":{"slot":2,"type":"STRING","value":"SRC_PTCH_SCHD_HR"}}},"19":{"slot":19,"values":{"1":{"slot":1,"type":"STRING","value":"compare_PITCH_OWNER"},"2":{"slot":2,"type":"STRING","value":"SRC_PTCH_OWNR"}}},"20":{"slot":20,"values":{"1":{"slot":1,"type":"STRING","value":"compare_PHONE_NUMBER"},"2":{"slot":2,"type":"STRING","value":"SRC_PH_NBR"}}},"21":{"slot":21,"values":{"1":{"slot":1,"type":"STRING","value":"compare_CUSTOM_SOURCE"},"2":{"slot":2,"type":"STRING","value":"SRC_CUSTOM_SRC"}}},"22":{"slot":22,"values":{"1":{"slot":1,"type":"STRING","value":"compare_PITCH_SCHEDULE_TYPE"},"2":{"slot":2,"type":"STRING","value":"SRC_PTCH_SCHD_TYP"}}},"23":{"slot":23,"values":{"1":{"slot":1,"type":"STRING","value":"compare_EVENT_NUMBER"},"2":{"slot":2,"type":"STRING","value":"SRC_EVNT_NBR"}}},"24":{"slot":24,"values":{"1":{"slot":1,"type":"STRING","value":"compare_PITCH_SCHEDULED_DOW"},"2":{"slot":2,"type":"STRING","value":"SRC_PITCH_SCHEDULED_DOW"}}}},"visible":true},"6":{"slot":6,"name":"Indicator Column","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SCD-FLAG"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"12702":{"id":12702,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":698,"y":143,"width":32,"height":32,"inputConnectorIDs":[12706],"outputConnectorIDs":[12705],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"F_INS_UPD"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SCD-FLAG"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"N"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"SCD-FLAG"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"C"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"OR"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"12703":{"id":12703,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":282,"y":239,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[12704],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"REF_ODS_PTCH_SCHD"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ODS_PITCH_SCHEDULED"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CUSTOMER_ID"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PUBLIC"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"BPF_ODS"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"12704":{"id":12704,"sourceID":12703,"targetID":12701},"12705":{"id":12705,"sourceID":12702,"targetID":12671},"12706":{"id":12706,"sourceID":12670,"targetID":12702},"12707":{"id":12707,"sourceID":12669,"targetID":12701},"12708":{"id":12708,"sourceID":12701,"targetID":12670}},"notes":{"12668":{"id":12668,"x":219,"y":100,"width":657,"height":187,"text":"ODS PITCH SCHEDULED","colour":"e6e63c"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"BPF_CUSTFNL_ODS_PITCH_SCHEDULED","description":null,"type":"TRANSFORMATION","tag":"dc077b90-20f2-4ae8-a37e-f332b6237fbf"}}